{#
  Template written and annotated by GitHub Copilot at the request of Fernando "ferabreu" Mees Abreu.
  See LICENSE file in the project root for full license information.

  Category creation and edit form. Allows admins to manage the category hierarchy.
#}

{% extends "base.html" %}

{% block content %}
    <form method="POST">
        {{ form.hidden_tag() }}
        
        <div class="mb-3">
            {{ form.name.label(class="form-label") }}
            {{ form.name(class="form-control", placeholder="Category name") }}
            {% for error in form.name.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        
        <div class="mb-3">
            <div id="category-dropdowns-label">{{ form.parent_id.label(class="form-label") }}</div>
            {{ form.parent_id(class="form-select", id="parent_id", style="display:none;") }}
            <div id="category-dropdowns"
                 data-hidden-field-id="parent_id"
                  data-subcategories-url="{{ url_for('categories.api_children', parent_id=0) | replace('0','{parent_id}') }}"
                  data-breadcrumb-url="{{ url_for('categories.api_breadcrumb', category_id=0) | replace('0','{category_id}') }}"
                 data-exclude-ids="{{ exclude_ids | tojson }}">
            </div>
            {% for error in form.parent_id.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <button type="submit" class="btn btn-primary">{{ action }}</button>
        <a href="{{ url_for('categories.admin_list') }}" class="btn btn-secondary">Cancel</a>
    </form>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/category_dropdowns.js') }}"></script>
{% endblock %}
